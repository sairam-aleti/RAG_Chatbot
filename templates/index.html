<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Verifiable Hybrid RAG Chatbot</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">

    <style>
        * { font-family: 'Inter', sans-serif; }
        .code-font { font-family: 'JetBrains Mono', monospace; }

        .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .gradient-text {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .chat-message-user {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 18px 18px 4px 18px;
        }
        .chat-message-ai {
            background-color: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 18px 18px 18px 4px;
        }

        /* Better bubble widths across devices */
        .chat-message-user, .chat-message-ai { max-width: 48rem; }
        @media (max-width: 1024px) { .chat-message-user, .chat-message-ai { max-width: 92%; } }
        @media (max-width: 640px)  { .chat-message-user, .chat-message-ai { max-width: 95%; } }

        .source-card { transition: all 0.2s ease; }
        .source-card:hover { transform: translateY(-2px); box-shadow: 0 10px 25px rgba(0,0,0,0.1); }

        .upload-area { border: 2px dashed #cbd5e0; transition: all 0.3s ease; }
        .upload-area:hover, .upload-area.dragover { border-color: #667eea; background-color: #f7fafc; }

        .progress-bar { height: 6px; border-radius: 3px; background-color: #e2e8f0; overflow: hidden; }

        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            transition: width 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        /* Option 1 UX: shimmer so it never feels idle */
        .progress-fill::after {
            content: "";
            position: absolute;
            top: 0;
            left: -40%;
            width: 40%;
            height: 100%;
            background: rgba(255, 255, 255, 0.35);
            transform: skewX(-20deg);
            animation: shimmer 1.2s infinite;
            pointer-events: none;
        }
        @keyframes shimmer {
            0% { left: -40%; }
            100% { left: 120%; }
        }

        .modal-overlay { background-color: rgba(0, 0, 0, 0.5); backdrop-filter: blur(4px); }

        /* Toggle switch styles */
        #hybridToggle:checked ~ .block { background-color: #10B981; }
        #hybridToggle:checked ~ .dot { transform: translateX(24px); }

        /* Responsive header spacing */
        @media (max-width: 768px) {
            #appContainer { padding-top: 1.25rem; padding-bottom: 1.25rem; }
        }

        /* ------------------------------------------------------------------
           Improve USER bubble header + text so it "syncs" with the background
           (works with your JS-generated markup; no JS changes required)
           ------------------------------------------------------------------ */
        #chatMessages .chat-message-user .flex.items-center.mb-2 {
            gap: 10px;
            margin-bottom: 10px;
        }

        /* Avatar chip (the "D") */
        #chatMessages .chat-message-user .flex.items-center.mb-2 > div:first-child {
            width: 34px !important;
            height: 34px !important;
            border-radius: 999px !important;
            background: rgba(255,255,255,0.24) !important;
            border: 1px solid rgba(255,255,255,0.18) !important;
            font-weight: 700 !important;
            letter-spacing: 0.2px;
        }

        /* "You" label */
        #chatMessages .chat-message-user .flex.items-center.mb-2 span {
            font-size: 0.95rem;
            opacity: 0.96;
            letter-spacing: 0.2px;
            text-shadow: 0 1px 10px rgba(0,0,0,0.25);
        }

        /* User message content */
        #chatMessages .chat-message-user p {
            font-size: 1.03rem;
            line-height: 1.6;
        }

        /* -------------------------
           Dark Mode (html.dark)
           ------------------------- */
        html.dark body { background: #0b1020 !important; }

        html.dark .bg-white { background-color: #111827 !important; }
        html.dark .bg-gray-50 { background-color: #0f172a !important; }
        html.dark .bg-gray-100 { background-color: #1f2937 !important; }

        html.dark .text-gray-800 { color: #e5e7eb !important; }
        html.dark .text-gray-700 { color: #d1d5db !important; }
        html.dark .text-gray-600,
        html.dark .text-gray-500 { color: #9ca3af !important; }

        html.dark .border-gray-200 { border-color: #243045 !important; }
        html.dark .border-gray-300 { border-color: #334155 !important; }

        html.dark .chat-message-ai { background-color: #0f172a; border-color: #243045; }

        /* Inputs in dark mode */
        html.dark input[type="text"],
        html.dark input[type="email"],
        html.dark input[type="password"] {
            background: #0b1020 !important;
            color: #e5e7eb !important;
            border-color: #334155 !important;
        }
        html.dark input::placeholder { color: #94a3b8 !important; }

        /* Upload section after file uploaded */
        html.dark #uploadedFile .bg-gray-50 { background-color: #0b1020 !important; }
        html.dark #fileName { color: #e5e7eb !important; }
        html.dark #fileInfo { color: #9ca3af !important; }

        /* Upload drop zone in dark mode */
        html.dark .upload-area { border-color: #334155; }
        html.dark .upload-area:hover,
        html.dark .upload-area.dragover { background-color: #0f172a; border-color: #667eea; }

        html.dark .progress-bar { background-color: #243045; }
        html.dark .progress-fill::after { background: rgba(255, 255, 255, 0.22); }

        /* Sample question buttons in welcome bubble */
        html.dark #chatMessages button.bg-gray-100 {
            background-color: #1f2937 !important;
            color: #e5e7eb !important;
        }
        html.dark #chatMessages button.bg-gray-100:hover { background-color: #334155 !important; }

        /* Stats blocks (Documents/Chat Sessions/...) */
        html.dark .bg-gray-50 p,
        html.dark .bg-gray-50 span { color: #9ca3af !important; }
        html.dark .bg-gray-50 .text-2xl { color: #e5e7eb !important; }

        /* System message bubble injected by JS */
        html.dark #chatMessages .bg-gray-100.border-gray-200 {
            background-color: #0f172a !important;
            border-color: #243045 !important;
        }
        html.dark #chatMessages .bg-gray-100 .text-gray-600 { color: #cbd5e1 !important; }

        /* Sources cards injected by JS */
        html.dark #sourcesPanel .bg-gray-50.border-gray-200 {
            background-color: #0f172a !important;
            border-color: #243045 !important;
        }
        html.dark #sourcesPanel .text-gray-700 { color: #d1d5db !important; }

        /* User menu dropdown in dark mode */
        html.dark #userMenu { background-color: #111827 !important; border-color: #243045 !important; }
        html.dark #userMenu button:hover { background-color: #0f172a !important; }

        /* ---- Cleaner dark-mode user bubble: slightly darker gradient + clearer text ---- */
        html.dark #chatMessages .chat-message-user {
            background: linear-gradient(135deg, #4f5bd5 0%, #5b2b8f 100%) !important;
        }
        html.dark #chatMessages .chat-message-user p {
            color: rgba(255,255,255,0.98) !important;
            text-shadow: 0 1px 12px rgba(0,0,0,0.35);
        }
        html.dark #chatMessages .chat-message-user .flex.items-center.mb-2 span {
            color: rgba(255,255,255,0.92) !important;
            text-shadow: 0 1px 12px rgba(0,0,0,0.35);
        }
        html.dark #chatMessages .chat-message-user .flex.items-center.mb-2 > div:first-child {
            background: rgba(255,255,255,0.34) !important;
            border: 1px solid rgba(255,255,255,0.25) !important;
        }
    </style>
</head>

<body class="bg-gray-50 min-h-screen">
    <!-- Authentication Modal -->
    <div id="authModal" class="fixed inset-0 z-50 flex items-center justify-center modal-overlay" style="display: none;">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-md mx-4 overflow-hidden">
            <div class="gradient-bg p-6 text-white">
                <h2 class="text-2xl font-bold" id="authTitle">Sign In</h2>
                <p class="text-blue-100">Access your Hybrid RAG Chatbot</p>
            </div>

            <div class="p-6" id="authForms">
                <!-- Sign In Form -->
                <div id="signinForm">
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-medium mb-2" for="signinEmail">Email</label>
                        <input type="email" id="signinEmail" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent outline-none transition">
                    </div>
                    <div class="mb-6">
                        <label class="block text-gray-700 text-sm font-medium mb-2" for="signinPassword">Password</label>
                        <input type="password" id="signinPassword" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent outline-none transition">
                    </div>
                    <button onclick="signIn()" class="w-full gradient-bg text-white font-medium py-3 rounded-lg hover:opacity-90 transition mb-4">
                        Sign In
                    </button>
                    <p class="text-center text-gray-600 text-sm">
                        Don't have an account?
                        <button onclick="showSignUp()" class="text-purple-600 font-medium hover:underline">Sign up</button>
                    </p>
                </div>

                <!-- Sign Up Form -->
                <div id="signupForm" style="display: none;">
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-medium mb-2" for="signupName">Full Name</label>
                        <input type="text" id="signupName" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent outline-none transition">
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-medium mb-2" for="signupEmail">Email</label>
                        <input type="email" id="signupEmail" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent outline-none transition">
                    </div>
                    <div class="mb-6">
                        <label class="block text-gray-700 text-sm font-medium mb-2" for="signupPassword">Password</label>
                        <input type="password" id="signupPassword" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent outline-none transition">
                    </div>
                    <button onclick="signUp()" class="w-full gradient-bg text-white font-medium py-3 rounded-lg hover:opacity-90 transition mb-4">
                        Create Account
                    </button>
                    <p class="text-center text-gray-600 text-sm">
                        Already have an account?
                        <button onclick="showSignIn()" class="text-purple-600 font-medium hover:underline">Sign in</button>
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Main App Container -->
    <div id="appContainer" class="max-w-7xl mx-auto px-4 py-8" style="display: none;">
        <!-- Header -->
        <header class="flex flex-col md:flex-row justify-between items-start md:items-center mb-10 gap-4">
            <div class="md:mb-0">
                <h1 class="text-3xl md:text-4xl font-bold gradient-text">Verifiable Hybrid RAG Chatbot</h1>
                <p class="text-gray-600 mt-2">Precision search with BM25 + Vector Fusion • Verifiable citations • Enterprise-ready</p>
            </div>
            <div class="flex flex-wrap items-center gap-3">
                <div class="flex items-center">
                    <div class="w-3 h-3 rounded-full bg-green-500 mr-2"></div>
                    <span class="text-sm text-gray-600" id="statusText">System Ready</span>
                </div>

                <!-- Dark Mode Toggle Button -->
                <button id="themeToggle" class="flex items-center space-x-2 bg-white px-4 py-2 rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition">
                    <i class="fas fa-moon text-gray-500" id="themeIcon"></i>
                    <span class="text-sm font-medium text-gray-700" id="themeLabel">Dark</span>
                </button>

                <div class="relative">
                    <button id="userMenuButton" class="flex items-center space-x-2 bg-white px-4 py-2 rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition">
                        <div class="w-8 h-8 rounded-full gradient-bg flex items-center justify-center text-white font-medium" id="userAvatar">U</div>
                        <span class="font-medium text-gray-700" id="userName">User</span>
                        <i class="fas fa-chevron-down text-gray-400 text-sm"></i>
                    </button>
                    <div id="userMenu" class="absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 z-10" style="display: none;">
                        <div class="p-4 border-b border-gray-100">
                            <p class="font-medium text-gray-800" id="menuUserName">User Name</p>
                            <p class="text-sm text-gray-500 truncate" id="menuUserEmail">user@example.com</p>
                        </div>
                        <button onclick="logout()" class="w-full text-left px-4 py-3 text-gray-700 hover:bg-gray-50 transition flex items-center">
                            <i class="fas fa-sign-out-alt mr-3 text-gray-400"></i> Sign Out
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content Grid -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- Left Column - PDF Upload & System Info -->
            <div class="lg:col-span-1 space-y-8">
                <!-- PDF Upload Card -->
                <div class="bg-white rounded-2xl shadow-lg p-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                        <i class="fas fa-file-pdf text-red-500 mr-3"></i> Document Upload
                        <div class="ml-2 text-gray-400 hover:text-gray-600" title="PDFs are chunked, embedded, and indexed in real-time using HuggingFace embeddings and FAISS vector store">
                            <i class="fas fa-info-circle text-sm"></i>
                        </div>
                    </h2>
                    <div class="upload-area p-8 rounded-xl text-center cursor-pointer" id="uploadArea" onclick="document.getElementById('fileInput').click()">
                        <i class="fas fa-cloud-upload-alt text-4xl text-gray-400 mb-4"></i>
                        <p class="text-gray-700 font-medium mb-1">Drop your PDF here or click to browse</p>
                        <p class="text-gray-500 text-sm">Supports PDF documents up to 50MB</p>
                        <input type="file" id="fileInput" accept=".pdf" class="hidden" onchange="handleFileSelect(event)">
                    </div>

                    <div class="mt-6" id="uploadProgress" style="display: none;">
                        <div class="flex justify-between mb-2 items-center">
                            <span class="text-sm font-medium text-gray-700 flex items-center">
                                <i class="fas fa-circle-notch fa-spin mr-2 text-purple-500"></i>
                                Processing
                            </span>
                            <span class="text-sm font-medium text-gray-700" id="progressPercent">0%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="progressFill" style="width: 0%"></div>
                        </div>
                        <p class="text-xs text-gray-500 mt-2" id="progressText">Initializing document processing...</p>
                    </div>

                    <div class="mt-6" id="uploadedFile" style="display: none;">
                        <div class="flex items-center justify-between bg-gray-50 p-4 rounded-lg">
                            <div class="flex items-center">
                                <i class="fas fa-file-pdf text-red-500 text-xl mr-3"></i>
                                <div>
                                    <p class="font-medium text-gray-800" id="fileName">document.pdf</p>
                                    <p class="text-sm text-gray-500" id="fileInfo">Processed and ready for querying</p>
                                </div>
                            </div>
                            <button onclick="removeFile()" class="text-gray-400 hover:text-red-500">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- System Architecture Card -->
                <div class="bg-white rounded-2xl shadow-lg p-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                        <i class="fas fa-cogs text-blue-500 mr-3"></i> Hybrid Search Engine
                    </h2>
                    <div class="space-y-4">
                        <div class="flex items-start">
                            <div class="w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center mr-3 flex-shrink-0">
                                <i class="fas fa-search text-blue-600"></i>
                            </div>
                            <div>
                                <h3 class="font-medium text-gray-800">BM25 Keyword Search</h3>
                                <p class="text-sm text-gray-600">Finds exact matches, rare words, and specific jargon</p>
                            </div>
                        </div>
                        <div class="flex items-start">
                            <div class="w-8 h-8 rounded-full bg-purple-100 flex items-center justify-center mr-3 flex-shrink-0">
                                <i class="fas fa-brain text-purple-600"></i>
                            </div>
                            <div>
                                <h3 class="font-medium text-gray-800">Vector Semantic Search</h3>
                                <p class="text-sm text-gray-600">Understands contextual meaning and relationships</p>
                            </div>
                        </div>
                        <div class="flex items-start">
                            <div class="w-8 h-8 rounded-full bg-green-100 flex items-center justify-center mr-3 flex-shrink-0">
                                <i class="fas fa-merge text-green-600"></i>
                            </div>
                            <div>
                                <h3 class="font-medium text-gray-800">RRF Fusion</h3>
                                <p class="text-sm text-gray-600">Reciprocal Rank Fusion combines both for optimal results</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Stats Card -->
                <div class="bg-white rounded-2xl shadow-lg p-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                        <i class="fas fa-chart-bar text-green-500 mr-3"></i> System Status
                    </h2>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-gray-50 p-4 rounded-lg">
                            <p class="text-sm text-gray-500">Documents</p>
                            <p class="text-2xl font-bold text-gray-800" id="docCount">0</p>
                        </div>
                        <div class="bg-gray-50 p-4 rounded-lg">
                            <p class="text-sm text-gray-500">Chat Sessions</p>
                            <p class="text-2xl font-bold text-gray-800" id="sessionCount">1</p>
                        </div>
                        <div class="bg-gray-50 p-4 rounded-lg">
                            <p class="text-sm text-gray-500">Response Time</p>
                            <p class="text-2xl font-bold text-gray-800" id="responseTime">~1.2s</p>
                        </div>
                        <div class="bg-gray-50 p-4 rounded-lg">
                            <p class="text-sm text-gray-500">Accuracy</p>
                            <p class="text-2xl font-bold text-gray-800" id="accuracyScore">98%</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Column - Chat Interface -->
            <div class="lg:col-span-2">
                <div class="bg-white rounded-2xl shadow-lg h-full flex flex-col">
                    <!-- Chat Header -->
                    <div class="border-b border-gray-200 p-6">
                        <div class="flex flex-col md:flex-row justify-between md:items-center gap-4">
                            <div>
                                <h2 class="text-xl font-bold text-gray-800">Chat with Document</h2>
                                <p class="text-gray-600 text-sm">
                                    Ask questions and get verifiable answers with citations
                                    <span class="text-green-600" title="Chat history persisted with MongoDB">
                                        <i class="fas fa-database ml-1"></i>
                                    </span>
                                </p>
                            </div>
                            <div class="flex items-center justify-between md:justify-end gap-4">
                                <div class="relative">
                                    <label class="flex items-center cursor-pointer">
                                        <div class="relative">
                                            <input type="checkbox" id="hybridToggle" class="sr-only" checked>
                                            <div class="block bg-gray-300 w-12 h-6 rounded-full"></div>
                                            <div class="dot absolute left-1 top-1 bg-white w-4 h-4 rounded-full transition transform duration-200 ease-in-out" id="toggleDot"></div>
                                        </div>
                                        <div class="ml-3 text-gray-700 font-medium">Hybrid Search</div>
                                        <div class="ml-2 text-gray-400 hover:text-gray-600" title="Combines BM25 keyword search with vector semantic search using Reciprocal Rank Fusion (RRF)">
                                            <i class="fas fa-info-circle text-sm"></i>
                                        </div>
                                    </label>
                                </div>
                                <button onclick="clearChat()" class="text-gray-500 hover:text-gray-700 flex items-center">
                                    <i class="fas fa-trash-alt mr-2"></i> Clear
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Chat Messages -->
                    <div class="flex-1 overflow-y-auto p-6" id="chatMessages">
                        <!-- Welcome message -->
                        <div class="mb-6">
                            <div class="chat-message-ai p-5">
                                <div class="flex items-center mb-3">
                                    <div class="w-8 h-8 rounded-full gradient-bg flex items-center justify-center text-white font-bold mr-3">AI</div>
                                    <span class="font-bold text-gray-800">Hybrid RAG Assistant</span>
                                </div>
                                <p class="text-gray-700">Hello! I'm your Verifiable Hybrid RAG Chatbot. I combine BM25 keyword search with vector semantic search to provide accurate, citation-backed answers from your documents.</p>
                                <p class="text-gray-700 mt-2">Upload a PDF document to get started, or try these sample questions:</p>
                                <div class="mt-3 flex flex-wrap gap-2">
                                    <button onclick="askSample('What are the main topics in this document?')" class="px-3 py-1.5 bg-gray-100 hover:bg-gray-200 rounded-lg text-sm text-gray-700 transition">Main topics?</button>
                                    <button onclick="askSample('Can you summarize the key points?')" class="px-3 py-1.5 bg-gray-100 hover:bg-gray-200 rounded-lg text-sm text-gray-700 transition">Key points?</button>
                                    <button onclick="askSample('Find specific references to dates or IDs')" class="px-3 py-1.5 bg-gray-100 hover:bg-gray-200 rounded-lg text-sm text-gray-700 transition">Find dates/IDs</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Chat Input -->
                    <div class="border-t border-gray-200 p-6">
                        <div class="flex">
                            <input type="text" id="chatInput" placeholder="Ask a question about your document..." class="flex-1 px-5 py-4 border border-gray-300 rounded-l-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent outline-none transition" onkeypress="if(event.key === 'Enter') sendMessage()">
                            <button onclick="sendMessage()" class="gradient-bg text-white px-6 rounded-r-lg hover:opacity-90 transition font-medium flex items-center">
                                <i class="fas fa-paper-plane mr-2"></i> Send
                            </button>
                        </div>
                        <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-2 mt-3">
                            <div class="text-xs text-gray-500">
                                <i class="fas fa-shield-alt mr-1"></i> All answers include verifiable source citations
                            </div>
                            <div class="text-xs text-gray-500">
                                <i class="fas fa-bolt mr-1"></i> Powered by Groq LLM + Hybrid RRF Fusion
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Sources Panel -->
        <div class="mt-8 bg-white rounded-2xl shadow-lg p-6" id="sourcesPanel" style="display: none;">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-bold text-gray-800 flex items-center">
                    <i class="fas fa-book-open text-purple-500 mr-3"></i> Source Citations
                </h2>
                <button onclick="toggleSources()" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="text-gray-600 mb-4">These are the sources used to generate the answer. Click to expand and verify the information.</div>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4" id="sourcesContainer"></div>
        </div>

        <!-- Footer -->
        <footer class="mt-12 pt-8 border-t border-gray-200 text-center text-gray-500 text-sm">
            <p>Verifiable Hybrid RAG Chatbot • Master's Level Architecture • BM25 + Vector Search with RRF Fusion</p>
            <p class="mt-2">Built with LangChain, Groq LLM, MongoDB, and Advanced Retrieval Algorithms</p>
        </footer>
    </div>

    <script src="/static/app.js"></script>

    <!-- Dark mode toggle (tiny JS; does not touch your app.js logic) -->
    <script>
      (function () {
        const root = document.documentElement;
        const btn = document.getElementById("themeToggle");
        const icon = document.getElementById("themeIcon");
        const label = document.getElementById("themeLabel");

        function apply(isDark) {
          root.classList.toggle("dark", isDark);
          if (icon) icon.className = isDark ? "fas fa-sun text-gray-500" : "fas fa-moon text-gray-500";
          if (label) label.textContent = isDark ? "Light" : "Dark";
        }

        const saved = localStorage.getItem("theme");
        if (saved === "dark") apply(true);

        btn?.addEventListener("click", () => {
          const isDark = !root.classList.contains("dark");
          apply(isDark);
          localStorage.setItem("theme", isDark ? "dark" : "light");
        });
      })();
    </script>
</body>
</html>